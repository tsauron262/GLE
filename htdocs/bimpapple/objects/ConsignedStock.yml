table: bimp_apple_consigned_stock
primary: id
icon: fas_box-open
common_fields: 0
    
nom_url: 
    syntaxe: <part_number>
    
list_page_url: 
    module: bimpsupport
    controller: index
    url_params: 
        tab: consigned_stock
        navtab-maintabs: cs_stocks

header_btn: 
    callback: getActionsButtons
    
header_list_name: default
header_edit_form: default
header_delete_btn: 0

labels: 
    name: stock consigné
    name_plur: stocks consignés
    
fields: 
    code_centre: 
        label: Centre
        required: 1
        values: 
            array: centres
        input: 
            type: select
            options: 
                callback: 
                    method: getCentresArray
                    params: 
                        - 0
        default_value: 
            callback: getDefaultCodeCentre
            
    part_number: 
        label: Réf. composant
        required: 1
        
    serialized: 
        label: Serialisé 
        type: bool
        default_value: 0
        
    qty: 
        label: Quantité
        type: qty
        decimals: 0
        default_value: 0
        min: 0
        display_if: 
            field_name: serialized
            show_values: 0
            
    serials: 
        label: Numéros de série
        type: items_list
        items_braces: 1
        display_if: 
            field_name: serialized
            show_values: 1
        
forms: 
    default: 
        rows: 
            - field: code_centre
            - field: part_number
            - field: serialized
            - custom: 1
              label: Quantité
              input_name: qty_tot
              data_type: qty
              input: 
                type: qty
              decimals: 0
              min: 0
              value: 1
              display_if: 
                field_name: serialized
                show_values: 0
                
    edit: 
        rows: 
            - field: serialized
    
    correct:
        rows: 
            centre: 
                field: code_centre
                edit: 0
            part: 
                field: part_number
                edit: 0
            mode: 
                custom: 1
                label: Mode de saisie
                input_name: mode
                input: 
                    type: select
                    options: 
                        total: Quantité totale du stock
                        add: Quantité à ajouter au stock
                        remove: Quantité à retirer du stock
                value: total
            qty: 
                field: qty
                label: Nouvelles quantités totales
                display_if: 
                    field_name: mode
                    show_values: total
            qty_to_add: 
                custom: 1
                label: Quantité à ajouter
                input_name: qty_to_add
                data_type: qty
                input: 
                    type: qty
                decimals: 0
                min: 0
                value: 0
                display_if: 
                    field_name: mode
                    show_values: add
            qty_to_remove: 
                custom: 1
                label: Quantité à retirer
                input_name: qty_to_remove
                data_type: qty
                input: 
                    type: qty
                decimals: 0
                min: 0
                value: 0
                display_if: 
                    field_name: mode
                    show_values: remove
            infos: 
                custom: 1
                label: Informations
                input_name: infos
                input: 
                    type: textarea
           
    correct_serialized: 
        extends: correct
        rows: 
            mode: unset
            qty_to_add: unset
            qty_to_remove: unset
            qty: 
                field: serials
                label: Numéros de série
                display_if: unset
            
    receive: 
        rows: 
            - custom: 1
              label: Centre
              input_name: code_centre
              input: 
                  type: select
                  options: 
                      callback: 
                          method: getCentresArray
                          params: 
                              - 0
            - custom: 1
              label: Status
              input_name: status
              input: 
                  type: select
                  options: 
                      - Ouvertes
                      - Toutes
            - custom: 1
              label: N° de livraison
              input_name: deliveryNumber
              content: 
                  callback: renderReceptionDeliveryNumberSelect
              display_if: 
                  field_name: code_centre
                  hide_values: ''
              depends_on: code_centre,status
              value: ''
            - custom: 1
              label: Unités reçues
              input_name: part_qties
              content: 
                  callback: renderDeliveryPartsQtyInputs
              display_if: 
                  field_name: deliveryNumber
                  hide_values: ''
              depends_on: code_centre,deliveryNumber
              
    create_shipment: 
        rows: 
            - custom: 1
              label: Centre
              input_name: code_centre
              input: 
                  type: select
                  options: 
                      callback: 
                          method: getCentresArray
                          params: 
                              - 1
            - custom: 1
              label: N° de commande
              input_name: orderId
              content: 
                  callback: renderShipmentOrderIdSelect
              display_if: 
                  field_name: code_centre
                  hide_values: ''
              depends_on: code_centre
              value: ''
#            - custom: 1
#              label: Unités reçues
#              input_name: part_qties
#              content: 
#                  callback: renderDeliveryPartsQtyInputs
#              display_if: 
#                  field_name: deliveryNumber
#                  hide_values: ''
#              depends_on: code_centre,deliveryNumber
              
filters_panels: 
    default: 
        filters: 
            code_centre: 
            part_number: 
            serialized: 
                
lists: 
    default: 
        title: Stocks consignés
        configurable: 1
        filters_panel: default
        filters_panel_open: 1
        sort_field: id
        sort_way: desc
        n: 10
        header_buttons: 
            callback: getListHeaderButtons
        add_form_name: default
        add_btn: 
            callback: isUserAdmin
        edit_btn: 1
        edit_form: edit
        extra_btn: 
            callback: getListExtraButtons
        cols:
            code_centre:
            part_number:
            qty:
            serials: