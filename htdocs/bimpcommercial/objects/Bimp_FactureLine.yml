extends: 
    module: bimpcommercial
    object_name: ObjectLine
    
abstract: 0
    
table: bimp_facture_line

parent_module: bimpcommercial
parent_object: Bimp_Facture

labels: 
    name: ligne de facture
    name_plur: lignes de facture
    is_female: 1

objects: 
    line: 
        relation: hasOne
        delete: 0
        instance: 
            dol_object: 
                module: compta/facture
                file: facture
                class: FactureLigne
            id_object: 
                field_value: id_line
        
        fields:
            date_start:
                label: Date de début
                type: date
            date_end:
                label: Date de fin
                type: date
                
    dol_line: 
        instance: 
            bimp_object: 
                name: FactureDolLine
       
    facture: 
        instance: 
            id_object: 
                field_value: id_obj
        
fields: 
    id_obj: 
        label: Facture
        search: 
            input: 
                type: search_list
                search_list: 
                    table: facture
                    fields_search: rowid,facnumber
                    field_return_label: facnumber
                    field_return_value: rowid
                    
    pa_editable: 
        label: Prix d'achat éditable
        type: bool
        default_value: 1
        
forms: 
    default: 
        rows: 
            pa_editable: 
                label: Activer la correction automatique du prix d'achat
                field: pa_editable
                display_if: 
                    field_name: type
                    show_values: 1
                    
    bulk_revalorisations: 
        rows: 
            type: 
                custom: 1
                label: Type
                input_name: type
                input: 
                    type: select
                    options: 
                        callback: getRevalTypesArray
                value: correction_pa
            date: 
                custom: 1
                label: Date
                input_name: date
                data_type: date
                input: 
                    type: date
                    display_now: 1
            amout_type: 
                custom: 1
                label: Type de montant
                input_name: amount_type
                input: 
                    type: select
                    options: 
                        new_pa: Nouveau Prix d'achat attendu
                        reval: 
                            label: Différence unitaire à corriger
                            help: Indiquez ci-dessous le montant unitaire à soustraire du prix d'achat actuel.</br>(Valeur négative si le prix d'achat doit être augmenté).
            amount: 
                custom: 1
                label: Montant
                input_name: amount
                data_type: money
                decimals: 7
                input: 
                    type: text
            note: 
                custom: 1
                label: Note
                input_name: note
                data_type: text
                input: 
                    type: textarea
                
filters_panels: 
    default: 
        filters: 
            parent: 
                label: Facture
            date_valid: 
                field: date_valid
                child: parent
            paye: 
                field: paye
                child: parent
            pa_editable: 
                label: Correction auto du PA
                field: pa_editable
            facnumber:
                field: facnumber
                child: parent
            datef: 
                field: datef
                child: parent
            fk_statut: 
                field: fk_statut
                child: parent
            type: 
                field: type
                child: parent
            ignore_compta: 
                field: ignore_compta
                child: parent
            tva: 
                field: tva
                child: parent
            zone_vente: 
                field: zone_vente
                child: parent
            type_soc: 
                custom: 1
                label: Type du client
                field: type_soc
                type: check_list
                items: 
                    array: typesSocietes
                
lists_cols: 
    reval: 
        label: Revalorisations
        value: 
            callback: displayRevalorisations
    date_valid: 
        field: date_valid
        child: parent
    pa_editable: 
        label: Corr. auto PA
        field: pa_editable
    note_private:
        field: note_private
        child: parent
    note_public:
        field: note_public
        child: parent
    entrepot:
        field: entrepot
        child: parent
        
lists: 
    default: 
        objects_change_reload: ObjectLineRemise,RemiseGlobale,Bimp_Facture,BimpRevalorisation
    global: 
        objects_change_reload: ObjectLineRemise,RemiseGlobale,Bimp_Facture,BimpRevalorisation
        list_actions: 
            - label: Revaloriser
              icon: fas_search-dollar
              action: bulkCreateRevalorisation
              form_name: bulk_revalorisations
        