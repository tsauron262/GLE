table: bimpcore_file
common_fields: 1

parent_module: 
    field_value: parent_module
parent_object: 
    field_value: parent_object_name
parent_id_property: id_parent
    
labels: 
    name: fichier

objects: 
    user_delete: 
        extends: user
        instance: 
            id_object: 
                field_value: user_delete
                
fields:
    parent_module:
        label: Module
        input: 
            type: hidden
        required: 1
            
    parent_object_name:
        label: Objet
        input: 
            type: hidden
        required: 1
            
    id_parent:
        label: ID Objet
        type: id_parent
        input: 
            type: hidden
        required: 1
            
    file_name:
        label: Nom
        input: 
            help: caractères alphanumériques et tirets (- ou _) seulements. Pas d'espaces ni d'accents. 
            
    file_ext: 
        label: Extension
        input: 
            type: hidden
            
    file_size: 
        label: Taille 
        type: int
        input: 
            type: hidden
            
    description:
        label: Description
        type: text
        input:
            auto_expand: 1
            rows: 1
            
    deleted: 
        label: Supprimé
        type: bool
        default_value: 0
        
    user_delete: 
        label: Supprimé par
        type: id_object
        object: user_delete
        default_value: 0
        
    date_delete: 
        label: Supprimé le
        type: datetime
    
    visibility:
        label: Visibilitée
        values:
            array: visibilities
        default_value:
            callback:
                method: currentContext
                params:
                    - default_value

forms:
    upload: 
        rows:
            - field: parent_module
            - field: parent_object_name
            - field: id_parent
            - label: Fichier
              custom: 1
              input_name: file
              input:
                  type: file_upload
              required: 1
            - field: file_name
              label: Nom à donner au fichier
            - field: description
            - field: visibility
              edit:
                  callback: currentContext
                  
                          
    edit:
        rows:
            - field: file_name
            - field: description
            - field: visibility
              edit:
                  callback: currentContext
      
lists_cols: 
    parent: 
        label: Propriétaire
        field: id_parent
        display: nom_url
    type: 
        label: Type
        value: 
            callback: displayType
    nom:
        field: file_name
    size: 
        field: file_size
    date:
        label: Date
        field: date_create
    descripton: 
        field: description
    visibility:
        field: visibility
        
lists:
    default:
        title: Fichiers
        checkboxes: 1
        bulk_actions: 
            - label: Supprimer les fichiers sélectionnés
              icon: fas_trash-alt
              onclick: deleteSelectedObjects('list_id', $(this));
              btn_class: deleteSelectedObjects
        objects_change_reload: 
            prop: 
                name: object_name
                object: 
                    callback: getParentInstance
        add_form_name: upload
        edit_btn: 1
        edit_form: edit
        list_filters:
            callback: getFilterListInterfaceClient
        delete_btn: 
            callback: isDeletable
        sort_field: id
        sort_way: asc
        n: 10
        extra_btn:
            callback: getDefaultListExtraButtons
        cols:
            type: 
            nom:
            size: 
            date:
            descripton:
            visibility:                    
        
    associates: 
        title: Fichiers associés
        checkboxes: 1
        bulk_actions: 
            - label: Supprimer les fichiers sélectionnés
              icon: fas_trash-alt
              onclick: deleteSelectedObjects('list_id', $(this));
              btn_class: deleteSelectedObjects
        edit_btn: 1
        edit_form: edit
        delete_btn: 
            callback: isDeletable
        sort_field: id
        sort_way: asc
        n: 10
        extra_btn:
            callback: getDefaultListExtraButtons
        cols:
            parent:
            type: 
            nom:
            size: 
            date:
            descripton: 
                
    