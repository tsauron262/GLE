table: product_stock
primary: rowid
icon: fas_box-open

labels: 
    name: Stock par entrepôt
    name_plur: Stocks par entrepôt
    is_female: 0
    
objects:   
    product: 
        instance: 
            id_object: 
                field_value: fk_product
            
    entrepot: 
        instance: 
            id_object: 
                field_value: fk_entrepot
                
    category: 
        relation: none
        delete: 0
        instance: 
            dol_object: 
                module: categories
                file: categorie
                
    marque: 
        extends: category
        relation: hasOne
        instance: 
            id_object: 
                field_value: marque
                
    gamme: 
        extends: category
        relation: hasOne
        instance: 
            id_object: 
                field_value: gamme
                
fields: 
    fk_entrepot: 
        label: Entrepot
        type: id_object
        object: entrepot
        values: 
            array: entrepots
        
    fk_product: 
        label: Produit
        type: id_object
        object: product
        input: 
            type: search_product
        display: 
            nom_url_libelle: 
                type: callback
                method: displayProduct
        
    reel: 
        label: Stock
        type: qty
        default_value: 0
        
    stockShowRoom: 
        label: Stock ShowRoom
        extra: 1
        type: int
        sortable: 0
        searchable: 0
        
    stockDate:
        label: Stock date
        extra: 1
        type: int
        sortable: 0
        searchable: 0
        
    ventes_qty:
        label: Nb Ventes
        extra: 1
        type: int
        sortable: 0
        searchable: 0
        
    ventes_ht:
        label: Ventes Ht
        extra: 1
        type: money
        sortable: 0
        searchable: 0
        
    derPv:
        label: Dernier prix de Vente
        extra: 1
        type: money
        sortable: 0
        searchable: 0
   
    product_categories: 
        label: Catégories produit
        extra: 1
        type: items_list
        items_data_type: id_object
        object: category
        
    cur_pa: 
        label: Prix d'achat actuel
        extra: 1
        type: money
        sortable: 0
        searchable: 0
        

    marque: 
        label: Marque
        extra: 1
        type: id_object
        object: marque
        values: 
            array: marques
            
    gamme: 
        label: Gamme matériel
        extra: 1
        type: id_object
        object: gamme
        values: 
            array: gammesMateriel
        
    type_materiel: 
        label: Type matériel
        value: 
            callback: displayTypeMateriel

lists_cols: 
    fk_entrepot: 
        field: fk_entrepot
        display: nom_url
    fk_product: 
        field: fk_product
        display: nom_url_libelle
    ref_prod: 
        label: Ref produit
        field: ref
        child: product
    label_prod: 
        label: Libellé produit
        field: label
        child: product
    reel: 
        field: reel
    stockShowRoom:
        field: stockShowRoom
    stockDate:
        field: stockDate
    stock_dispo: 
        label: Stock dispo
        value: 
            callback:
                method: getStockByType
                params: 
                    - dispo
    stock_virtuel: 
        label: Stock virtuel
        value: 
            callback:
                method: getStockByType
                params: 
                    - virtuel
    ventes_qty:
        field: ventes_qty
    ventes_ht:
        field: ventes_ht
    derPv:
        field: derPv
    cur_pa: 
        field: cur_pa
    last_pa: 
        label: Dernier PA fourn enregistré
        value:
          callback: displayLastBuyPrice
    date_last_vente: 
        label: Date dernière vente
        value: 
            callback: displayLastVenteDate
    date_last_achat:
        label: Date dernier achat
        value: 
            callback: displayLastAchatDate
    cur_pa_date:
        label: Prix d'achat courant a date
        value: 
            callback: displayCur_pa_date
    marque: 
        field: marque
    gamme: 
        field: gamme
    type_materiel: 
        label: Type matériel
        value: 
            callback: displayTypeMateriel
    price:
        child: product
        field: price
    price_ttc:
        child: product
        field: price_ttc
    stock_desire: 
        label: Stock desire
        value: 
            callback: displayStockDesire
    stock_alert: 
        label: Stock Alert
        value: 
            callback: displayStockAlert
    categorie:
        child: product
        field: categorie
    collection:
        child: product
        field: collection
    nature:
        child: product
        field: nature
    famille:
        child: product
        field: famille
    gamme:
        child: product
        field: gamme
                
lists: 
    default: 
        title: 
            callback: displayTitre
        icon: fas_box-open
        checkboxes: 1
        configurable: 1
        bulk_actions:
            - label: étiquettes stock
              icon: fas_sticky-note
              onclick: setSelectedObjectsAction($(this), 'list_id', 'printEtiquettes', {'type':'stock'}, '', 'Générer les étiquettes ?', true)
            - label: étiquettes magasin
              icon: fas_sticky-note
              onclick: setSelectedObjectsAction($(this), 'list_id', 'printEtiquettes', {'type':'magasin'}, '', 'Générer les étiquettes ?', true)
        filters_panel: default
        sort_field: fk_entrepot
        sort_way: desc
        n: 50
        cols: 
            fk_entrepot: 
            fk_product: 
            reel: 
            stockShowRoom:
            stockDate:
            ventes_qty:
            ventes_ht:
            derPv:
            last_pa: 
            cur_pa:
            marque: 
            gamme:
            type_materiel:
                
    product: 
        extends: default
        filters_panel: product
        n: 10
        cols: 
            stock_dispo: 
            stock_virtuel:
                
            fk_product: unset
            stockShowRoom: unset
            stockDate: unset
            ventes_qty: unset
            ventes_ht: unset
            derPv: unset
            last_pa: unset
            cur_pa: unset
            marque: unset
            gamme: unset
            type_materiel: unset
               
filters_panels: 
    default: 
        filters: 
            entrepot: 
                field: fk_entrepot
            product: 
                field: fk_product
            stock: 
                field: reel
            categ1:
                custom: 1
                label: Catégorie (1)
                field: categ1
                type: value
                input:
                    type: select
                    options: 
                        callback: getCategoriesArray
            categ2:
                custom: 1
                label: Catégorie (2)
                field: categ2
                type: value
                input:
                    type: select
                    options: 
                        callback: getCategoriesArray
            categ3:
                custom: 1
                label: Catégorie (3)
                field: categ3
                type: value
                input:
                    type: select
                    options: 
                        callback: getCategoriesArray
            stockDateDifZero:
                custom: 1
                label: Stock a date <> 0
                field: stockDateDifZero
                type: check_list
                items: 
                  1: OUI
                exclude_btn: 0
            categorie:
                child: product
                field: categorie
            collection:
                child: product
                field: collection
            nature:
                child: product
                field: nature
            famille:
                child: product
                field: famille
            gamme:
                child: product
                field: gamme
                
    product: 
        extends: default
        filters: 
            product: unset
            categ1: unset
            categ2: unset
            categ3: unset
            categorie: unset
            collection: unset
            nature: unset
            famille: unset
            gamme: unset
