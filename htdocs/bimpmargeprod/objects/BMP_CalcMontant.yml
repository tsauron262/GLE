table: bmp_calc_montant
common_fields: 0

labels:
    name: calcul automatique
    name_plur: calculs automatiques

objects: 
    type_montant_src:
        relation: HasOne
        delete: 0
        instance: 
            bimp_object: BMP_TypeMontant
            id_object: 
                field_value: id_montant_source
    
    total_src:
        relation: hasOne
        delete: 0
        instance: 
            bimp_object: BMP_TotalInter
            id_object:
                field_value: id_total_source
    
    type_montant_tgt:
        relation: HasOne
        delete: 0
        instance: 
            bimp_object: BMP_TypeMontant
            id_object: 
                field_value: id_target
            
fields:
    label: 
        label: Description
        type: string
        
    type_source:
        label: Type source
        type: int
        values: 
            array: 
                1: Montant enregistré
                2: Total intermédiaire
                3: Montant fixe
        
    id_montant_source: 
        label: Montant source
        type: id_object
        object: type_montant_src
        required: 0
        default_value: 0
        values: 
            array: types_montants
        display_if:
            field_name: type_source
            show_values: 1,
    
    id_total_source: 
        label: Total intermédiaire source
        type: id_object
        object: total_src
        required: 0
        default_value: 0
        values: 
            array: totaux_inter
        display_if:
            field_name: type_source
            show_values: 2,
            
    source_amount: 
        label: Montant source fixe
        type: money
        required: 0
        default_value: 0
        display_if:
            field_name: type_source
            show_values: 3
        
    id_target: 
        label: Montant cible
        type: id_object
        object: type_montant_tgt
        required: 1
        values: 
            array: types_montants
            
    percent: 
        label: Pourcentage par défaut
        type: percent
        required: 1
        decimals: 6
        
    editable: 
        label: Editable
        type: bool
        default_value: 1
        
    required: 
        label: Obligatoire
        type: bool
        default_value: 1
        
    active:
        label: Activé
        type: bool
        default_value: 1
        
lists:
    default: 
        title: Calculs automatiques
        icon: cogs
        checkboxes: 1
        bulk_actions:
            - label: supprimer les calculs auto sélectionnés
              icon: fas_trash-alt
              onclick: deleteSelectedObjects('list_id', $(this))
        sort_field: label
        sort_way: asc
        n: 25
        delete_btn: 1
        update_btn: 1
        add_form_name: default
        edit_form: default
        edit_btn: 1
        cols: 
            label: 
                field: label
            source:
                label: Source
                value: 
                    callback: displaySource
            target: 
                field: id_target
            parcent: 
                field: percent
            editable: 
                field: editable
                edit: 1
            required: 
                field: required
                edit: 1
            active: 
                field: active
                edit: 1