parent_id_property: id_obj
positions: 1
position_insert: after
common_fields: 0

parent_id_property: id_obj

objects:    
    product: 
        relation: hasOne
        delete: 0
        instance: 
            bimp_object:
                module: bimpcore
                name: Bimp_Product
            id_object: 
                prop: id_product
                
    equipment: 
        relation: hasOne
        delete: 0
        instance: 
            bimp_object: 
                module: bimpequipment
                name: Equipment
            id_object: 
                field_value: id_equipment

    fournisseur_price: 
        relation: none
        delete: 0
        instance: 
            bimp_object: 
                module: bimpcore
                name: Bimp_ProductFournisseurPrice
                
fields: 
    id_obj: 
        label: Objet
        type: id_parent
        required: 1
        
    id_line: 
        label: Ligne
        type: id
        
    type: 
        label: Type
        type: int
        values: 
            array: types
        required: 1
        
    id_equipment: 
        label: Equipement
        type: id_object
        object: equipment
        input: 
            type: search_list
            search_list:
                table: be_equipment e
                field_return_value: e.id
                field_return_label: e.serial
                fields_search: e.serial,e.id
            help: Numéro de série ou ID d'un équipement<br/>Laissez vide pour attribuer un équipement ultérieurement
        create_form: light
        display_if: 
            field_name: type
            show_values: 1
                
        display: 
            default: 
                type: callback
                method: displayEquipment
        
    deletable: 
        label: Supprimable
        type: bool
        default_value: 1
        
    editable: 
        label: Editable
        type: bool
        default_value: 1
        
    linked_id_object: 
        label: Objet lié
        type: id_object
        
    linked_object_name:
        label: Type d\'objet lié

forms: 
    equipment:
        title: Attribuer un équipement
        rows: 
            - field: id_equipment
            - custom: 1
              label: Prix unitaire HT
              value: 
                  prop: pu_ht
              input_name: pu_ht
              content: 
                  callback: 
                      method: renderLineInput
                      params: 
                          - pu_ht
              depends_on: id_equipment
              
            - custom: 1
              label: Taux de TVA
              value: 
                  prop: tva_tx
              input_name: tva_tx
              content: 
                  callback: 
                      method: renderLineInput
                      params: 
                          - tva_tx
              depends_on: id_equipment
            - custom: 1
              label: Prix d'achat
              input_name: id_fourn_price
              data_type: id_object
              content: 
                  callback: 
                      method: renderLineInput
                      params: 
                          - id_fourn_price
              depends_on: id_equipment

lists: 
    default: 
        checkboxes: 1
        positions: 1
        enable_search: 0
        enable_sort: 0
        pagination: 0
        bulk_actions:
            - label: supprimer les lignes sélectionnées
              icon: trash
              onclick: deleteSelectedObjects('list_id', $(this))
        sort_field: position
        sort_way: asc
        n: 0
        single_cell:
            filters:
                type: 2
            col: desc
        add_btn: 
            callback: isParentEditable
        add_form_name: default
        add_btn_label: Ajouter une ligne
        edit_btn: 
            callback: isEditable
        update_btn: 
            callback: isEditable
        delete_btn: 
            callback: isDeletable
        item_checkbox: 
            callback: isDeletable
        extra_btn: 
            callback: getListExtraBtn
        cols:
            desc:
                label: Description
                value: 
                    callback: 
                        method: displayLineData
                        params:
                            - desc
                max_width: 460px
            pu_ht: 
                label: PU HT
                value: 
                    callback:
                        method: displayLineData
                        params:
                            - pu_ht
            tva:
                label: TVA
                value: 
                    callback:
                        method: displayLineData
                        params:
                            - tva_tx
            remise: 
                label: Remise
                value: 
                    callback: 
                        method: displayLineData
                        params: 
                            - remise
                            - 1
                min_width: 130px
                max_width: 130px
            pa_ht: 
                label: PA HT
                value: 
                    callback:
                        method: displayLineData
                        params:
                            - pa_ht
            qty: 
                label: Qté
                value: 
                    callback: 
                        method: displayLineData
                        params:
                            - qty
                            - 1
            total_ttc: 
                label: Total TTC
                value: 
                    callback:
                        method: displayLineData
                        params:
                            - total_ttc
            margin: 
                label: Marge
                value: 
                    callback: 
                        method: displayLineData
                        params:
                            - margin
                  