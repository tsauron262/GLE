bootstrap: 1
table: contratdet

parent_id_property: fk_contrat
parent_object: BContract_contrat

dol_object: 
    instance: 
        dol_object: 
            module: contrat
            file: contrat
            class: ContratLigne

primary: rowid
force_extrafields_update: 1
labels: 
    name: ligne du contrat
    name_plur: lignes du contrat
    is_female: 1

objects:
    produit:
        instance: 
            bimp_object:
                module: bimpcore
                name: Bimp_Product
            id_object:
                field_value:
                    fk_product

fields:
    rowid:
        label: N°
        type: int
    description:
        label: Description de la ligne
        type: string
        required: 1
    fk_contrat:
        label: Contrat
        type: int
    fk_product:
        label: produit
        type: id_object
        object: produit
        required: 1
        input: 
            type: search_product
            help: Entrez le nom ou la référence d'un produit pour effectuer une recherche
            card: default
        search:
            input: 
                type: search_product
                societe_type: customer    
    qty:
        label: Qté service
        type: qty
        default_value: 1
    price_ht:
        label: P.U HT
        type: money
    tva_tx: 
        label: Taux de TVA
        type: percent
        default_value: 20
    total_ttc: 
        label: Total TTC
        type: money
    remise_percent:
        label: Remise
        type: percent
        default_value: 0
    remise:
        label: Total remise
        type: money
    # Extrafields
    serials:
        label: Numéros de série
        dol_extra_field: 1
        type: text
        input:
            help: Merci de séparer les numéros de série par une virgule (,)
    nb_materiel:
        label: Qté matériel
        dol_extra_field: 1
        default_value:
            callback: getNbMateriel
        type: qty
        required: 1

lists: 
    default: 
        title: Lignes du contrat
        icon: fas_file-contract
        sort_field: tms
        sort_way: desc
        n: 20
        checkbox: 1
        add_object_row: 0
        update_btn: 1
        edit_btn: 1
        edit_form: default
        add_form_name: add
        delete_btn: 1
        page_btn: 1
        cols: 
            description:
                field: description
            fk_product:
                field: fk_product
                display: nom_url
            qty:
                field: qty
            tva_tx:
                field: tva_tx
            remise_percent:
                field: remise_percent
            remise:
                field: remise
            price_ht:
                field: price_ht
            total_ttc:
                field: total_ttc
            nb_materiel:
                field: nb_materiel
            serials:
                field: serials
forms:
    default:
        rows:
            - field: rowid
              edit: 0
              show: 0
            - field: description
            - field: fk_product
              edit: 0
            - field: tva_tx
            - field: qty
            - field: remise_percent
            
    add:
        rows:
            - field: description
            - field: fk_product
            - field: qty
            - custom: 1
              input:
                  type: qty
              label: Nb matériel
              default_value: 0
              required: 1
              input_name: nb_materiel
            - field: serials
            - field: remise_percent
            - field: tva_tx
              