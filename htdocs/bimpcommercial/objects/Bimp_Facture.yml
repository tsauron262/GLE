extends: 
    module: bimpcommercial
    object_name: BimpComm

abstract: 0

dol_object: 
    instance: 
        dol_object: 
            module: compta/facture
            file: facture
            
force_extrafields_update: 1

table: facture
controller: facture
icon: fas_file-invoice-dollar

nom_url: 
    with_status: 0
    card: light

list_page_url: 
    controller: factures

labels: 
    name: facture
    is_female: 1
    
objects: 
    lines: 
        instance: 
            bimp_object: Bimp_FactureLine
                
    account: 
        instance:
            id_object: 
                field_value: fk_account
    
    files:
        list: 
            filters:
                parent_object_name: Bimp_Facture
        add_form: 
            values:
                fields: 
                    parent_object_name: Bimp_Facture
                    
    user_commission: 
        extends: commission
        instance: 
            id_object: 
                field_value: id_user_commission
                
    entrepot_commission: 
        extends: commission
        instance: 
            id_object: 
                field_value: id_entrepot_commission
                    
    user_irrecouvrable: 
        extends: user
        instance: 
            id_object: 
                field_value: id_user_irrecouvrable
                
    facture_source:
        extends: facture
        instance: 
            id_object: 
                field_value: fk_facture_source
        
    client_final: 
        extends: client
        instance: 
            id_object: 
                field_value: id_client_final
        
fields: 
    id_client_final: 
        label: Client final
        type: id_object
        object: client_final
        input: 
            help: laisser vide si même client
        default_value: 0
    exported:
        label: Etat comptable
        type: int
        values: 
            array: exportedStatut
    ignore_compta:
        label: Ignorée en compta
        type: bool
        dol_extra_field: 1
    type: 
        label: Type
        type: int
        values: 
            array: types
        input: 
            type: select
            options: 
                array: selectTypes
        depends_on: fk_soc
    model_pdf: 
        default_value: bimpfact
    datec: 
        label: Créée le
        type: datetime
    datef: 
        label: Date facturation
        dol_prop: date
        type: date
        input: 
            display_now: 1
        required: 1
    date_lim_reglement:
        label: Date limite de réglement
        type: date
    fk_account: 
        label: Compte bancaire
        type: id_object
        object: account
        input: 
            type: select_mysoc_account
        default_value:
            callback: getDefaultBankAccount
    centre: 
        label: Centre
        dol_extra_field: 1
        values: 
            array: centres
        display_if: 
            field_name: ef_type
            show_values: S
        default_value: ''
        
    # Anciennement "total"    
    total_ht: 
        label: Total HT
        type: money
    total_ttc: 
        label: Total TTC
        type: money
    fk_user_author: 
        dol_prop: user_author
    fk_user_valid: 
        dol_prop: unset
        no_dol_prop: 1
    paye: 
        label: Entièrement payé(e)
        type: bool
        default_value: 0
        display: 
            short: 
                type: callback
                method: displayPaidStatus
                params: 
                    - 0
                    - 1
        show:
            callback:
                method: getGeneralConf
                params:
                    - use_payments
    pdf_hide_pu: 
        label: Masquer les prix unitaires dans le PDF
        dol_extra_field: 1
        type: bool
        default_value: 0
        sortable: 0
    pdf_nb_decimal: 
        label: Nombre de décimals dans le PDF
        dol_extra_field: 1
        type: int
        sortable: 0
    pdf_hide_ref:
        label: Masquer les références des produits dans le PDF
        dol_extra_field: 1
        type: bool
        default_value: 0
        sortable: 0
    marge: 
        label: Marge
        type: money
        default_value: 0
    id_user_commission: 
        label: Commission utilisateur
        type: id_object
        object: user_commission
        default_value: 0
    id_entrepot_commission: 
        label: Commission entrepôt
        type: id_object
        object: entrepot_commission
        default_value: 0
    multicurrency_total_ht:
        label: TOTAL HT (compta)
        type: money
    multicurrency_total_ttc:
        label: TOTAL TTC (compta)
        type: money
    multicurrency_total_tva:
        label: TOTAL TVA (compta)
        type: money
    fk_facture_source:
        label: Facture source
        type: id_object
        object: facture_source
    statut_export:
        label: Statut export
        type: int
        user_edit: 1
        values: 
            array: statut_export
    douane_number:
        label: N° Douane
        user_edit: 1
    relance_active:
        label: Relances paiements autorisées
        type: bool
        default_value: 1
        history: 1
    nb_relance:
        label: Nombre de relances
        type: int
        default_value: 0
        displays: 
            badge: 
                label: Badge
                type: callback
                method: displayNbRelanceBadge
    date_relance: 
        label: Date de dernière relance
        type: date
    date_next_relance: 
        label: Date de prochaine relance
        type: date
    paiement_status: 
        label: Statut paiement
        type: int
        values: 
            array: paiement_status
        default_value: 0
        show:
            callback:
                method: getGeneralConf
                params:
                    - use_payments
    remain_to_pay: 
        label: Reste à payer
        type: money
        default_value: 0
    close_code: 
        label: Code abandon
    close_note: 
        label: Motif abandon
        type: text
    date_irrecouvrable: 
        label: Déclarée irrécouvrable le
        type: datetime
    id_user_irrecouvrable: 
        label: Déclarée irrécouvrable par
        type: id_object
        object: user_irrecouvrable
        default_value: 0
    prelevement: 
        label: Prélèvement mis en place
        type: bool
        default_value: 0
    marge_finale_ok: 
        label: Marge + reval OK
        type: money
        default_value: 0
    total_achat_reval_ok: 
        label: Total achat (reval OK)
        type: money
        default_value: 0        
    litige: 
        label: Litige
        dol_extra_field: 1
        type: bool
        default_value: 0
    chorus_status: 
        label: Statut export chorus
        dol_extra_field: 1
        type: int
        default_value: -1
        values: 
            array: chorus_status
    chorus_data:
        label: Données Chorus
        dol_extra_field: 1
        type: json
    date_cfr:
        label: Date de dépot CFR
        dol_extra_field: 1
        type: datetime
    fk_mode_reglement: 
        history: 1
    pdf_hide_livraisons: 
        label: Masquer l'adresse de livraison dans le PDF
        type: bool
        default_value: 0
    alert_abonnement_unpaid_send: 
        label: Alerte non paiement des abonnements envoyée
        type: bool
        default_value: 0
    
    # Validation d'avoir
    valid_avoir_fichier_joints:
        label: Justificatif demande d'avoir
        dol_extra_field: 1
        type: json
    valid_avoir_montant:
        label: Montant avoir demandé
        dol_extra_field: 1
        type: money
    valid_avoir:
        label: Avoir accepté
        dol_extra_field: 1
        type: bool
        input: 
            type: toggle
        default_value: 0
    valid_avoir_id_user_ask:
        label: Demandeur de l'avoir
        dol_extra_field: 1
        type: id_object
        object: user
    valid_avoir_id_user:
        label: Valideur de l'avoir
        dol_extra_field: 1
        type: id_object
        object: user
    valid_avoir_montant_accorder:
        label: Montant avoir accordé
        dol_extra_field: 1
        type: money
        
    fk_availability: unset
    fk_input_reason: unset
       
forms: 
    default: 
        msgs: 
            callback: renderCreateWarning
        rows:
            origin: 
                custom: 1
                lable: Origine
                input_name: origin
                input: 
                    type: hidden
                value: 
                    request_field: origin
                hidden: 1
            origin_id: 
                custom: 1
                lable: Origine
                input_name: origin_id
                data_type: int
                input: 
                    type: hidden
                value: 
                    request_field: origin_id
                hidden: 1
            replaced_ref: 
                field: replaced_ref
            soc: 
                field: fk_soc
            client_final: 
                field: id_client_final
            ref_client: 
                field: ref_client
            type: 
                field: type
                show: 
                    callback: isNotLoaded
            typedeposit: 
                custom: 1
                label: Type d'acompte
                input_name: typedeposit
                input: 
                    type: select
                    options: 
                        array: typesDeposit
                display_if:
                    fields_names: type,origin
                    type: 
                        hide_values: 1,2,4,5
                    origin: 
                        show_values: propal,commande
                show: 
                    callback: isNotLoaded
            id_facture_replaced: 
                custom: 1
                label: Facture remplacée
                input_name: id_facture_replaced
                data_type: int
                input: 
                    type: select
                    options: 
                        array: replacedInvoices
                value: 
                    callback: getRequestIdFactureReplaced
                display_if: 
                    field_name: type
                    show_values: 1
                show: 
                    callback: isNotLoaded
                depends_on: fk_soc
            id_facture_to_correct: 
                custom: 1
                label: Facture à corriger
                input_name: id_facture_to_correct
                data_type: int
                input: 
                    type: select
                    options: 
                        array: FacturesToCorrect
                value: 
                    callback: getRequestIdFactureToCorrect
                display_if: 
                    field_name: type
                    show_values: 2
                depends_on: fk_soc
                show: 
                    callback: isNotLoaded
#            avoir_same_lines: 
#                custom: 1
#                label: Créer l'avoir avec les même lignes que la factures dont il est issu
#                data_type: bool
#                input: 
#                    type: toggle
#                value: 1
#                input_name: avoir_same_lines
#                display_if: 
#                    fields_names: type,id_facture_to_correct
#                    type: 
#                        show_values: 2
#                    id_facture_to_correct:
#                        hide_values: 0
#                show: 
#                    callback: isNotLoaded
#            avoir_remain_to_pay: 
#                custom: 1
#                label: Créer l'avoir avec le montant restant à payer de la facture dont il est issu.
#                data_type: bool
#                input: 
#                    type: toggle
#                value: 0
#                input_name: avoir_remain_to_pay
#                display_if: 
#                    fields_names: type,id_facture_to_correct
#                    type: 
#                        show_values: 2
#                    id_facture_to_correct:
#                        hide_values: 0
#                show: 
#                    callback: isNotLoaded
            ef_type: 
                field: ef_type
            entrepot:
                field: entrepot
                show:
                    callback: isEditable
            centre: 
                field: centre
                show: 
                    callback: isEditable
            libelle: 
                field: libelle
            expertise:
                field: expertise
                edit: 1
            datef: 
                field: datef
                show: 
                    callback: isEditable
            cond_reglement: 
                field: fk_cond_reglement
                show: 
                    callback: isEditable
            mode_reglement: 
                field: fk_mode_reglement
                show: 
                    callback: isEditable
            rib_client:
                field: rib_client
#            date_lim_reglement: 
#                field: date_lim_reglement
            account: 
                field: fk_account
                show: 
                    callback: isEditable
            pdf_hide_pu: 
                field: pdf_hide_pu 
#            pdf_hide_reduc: 
#                field: pdf_hide_reduc
#            pdf_hide_total: 
#                field: pdf_hide_total
#            pdf_hide_ttc: 
#                field: pdf_hide_ttc
            model_pdf: 
                field: model_pdf
            zone_vente: 
                field: zone_vente
                show: 
                    callback: isLoaded
            note_private: 
                field: note_private
            note_public: 
                field: note_public
            statut_export:
                field: statut_export
            douane_number:
                field: douane_number
            prime:
                field: prime
            prime2:
                field: prime2
            relance_active: 
                field: relance_active
            
    refacture: 
        extends: default
        msgs: unset
        rows: 
            type: 
                field: unset
                show: unset
                label: Type
                custom: 1
                hidden: 1
                input_name: type
                data_type: int
                input: 
                    type: hidden
                value: 0
                
            id_avoir_to_refacture: 
                custom: 1
                hidden: 1
                label: Avoir à refacturer
                input_name: id_avoir_to_refacture
                data_type: id
                input: 
                    type: hidden
                
            typedeposit: unset
            id_facture_replaced: unset
            id_facture_to_correct: unset
#            avoir_same_lines: unset
#            avoir_remain_to_pay: unset
            
    paid_partially:
        msgs: 
            - content: Cette facture n'a pas été payée à hauteur du montant initial. Pour quelle raison voulez-vous la classer payée malgré tout?
              type: warning
        rows: 
            - custom: 1
              label: Raison
              input_name: close_code
              input: 
                  type: select
                  options: 
                      array: closeReasons
            - custom: 1
              label: Commentaires
              input_name: close_note
              input: 
                  type: textarea
                  rows: 3
                  auto_expand: 1
                  
    cancel:
        msgs: 
            - content: Pour quelle raison voulez-vous classer la facture abandonnée ?
              type: warning
        rows: 
            - custom: 1
              label: Raison
              input_name: close_code
              input: 
                  type: select
                  options: 
                      array: cancelReasons
            - custom: 1
              label: Commentaires
              input_name: close_note
              input: 
                  type: textarea
                  rows: 3
                  auto_expand: 1
                  
    duplicate:
        force_edit: 1
        rows:
            - custom: 1
              label: Date
              input_name: datef
              input: 
                type: date
            - field: fk_account
            - custom: 1
              label: Recap
              input_name: lines
              content:
                  callback: renderTotals
            - custom: 1
              label: Valider
              input_name: validate
              data_type: bool
              input:
                  type: toggle
              value: 0
            - custom: 1
              label: Créer paiement
              input_name: addPaiement
              data_type: bool
              display_if:
                  field_name: validate
                  show_values: 1
              input:
                  type: toggle
              value: 0
                
    validate: 
        title: Validation
        rows: 
            - field: datef
            - custom: 1
              label: Informations
              input_name: validation_type
              content: 
                  callback: renderValidationFormInfos
            - custom: 1
              label: Déplacer les lignes négatives dans un avoir
              input_name: create_avoir
              data_type: bool
              input: 
                  type: toggle
              value: 0
              display_if: 
                  field_name: validation_type
                  show_values: 2
            - custom: 1
              label: Convertir l'avoir en remise
              input_name: convert_avoir_to_reduc
              data_type: bool
              input: 
                  type: toggle
              value: 1
              display_if: 
                  fields_names: validation_type,create_avoir
                  validation_type: 
                      show_values: 1,2
                  create_avoir: 
                      hide_values: 0
            - custom: 1
              label: Appliquer la remise à la facture
              input_name: use_discount_in_facture
              data_type: bool
              input: 
                  type: toggle
              value: 1
              display_if: 
                  fields_names: validation_type,convert_avoir_to_reduc,create_avoir
                  validation_type: 
                      show_values: 1,2
                  convert_avoir_to_reduc: 
                      hide_values: 0
                  create_avoir: 
                      hide_values: 0
            - custom: 1
              hidden: 1
              input_name: show_force_validation
              data_type: bool
              input: 
                  type: hidden
              value: 
                  callback: showForceValidation
            - custom: 1
              label: Forcer la validation
              input_name: force_validate
              content: 
                  callback: renderForceValidationInput
              display_if: 
                  field_name: show_force_validation
                  show_values: 1
                  
    add_to_commission: 
        title: Ajout à une commission
        rows: 
            - custom: 1
              label: Commission
              input_name: id_commission
              data_typel: id
              input: 
                  type: select
                  options: 
                      array: draftCommissions
                      
    check_pa: 
        modal_format: large
        title: Vérification des prix d\'achat
        rows: 
#            - custom: 1
#              label: Prix d'achat attendus
#              input_name: type_check
#              input: 
#                  type: select
#                  options: 
#                      create: Prix d'achat des produits en cours à la date de création de la facture
#                      validate: Prix d'achat des produits en cours à la date de validation de la facture
#                      current: Prix d'achat actuels des produits
#              value: create
            
            - custom: 1
              label: Résultat
              input_name: result
              content: 
                  callback: renderCheckPaForm
#              depends_on: type_check
    check_ra: 
        rows: 
            - custom: 1
              label: Recréer une nouvelle revalorisation en cas d'écart
              input_name: recreate_revals
              input: 
                  type: toggle
                  help: Les revalorisations actuelles seront supprimées quelque soient leurs statuts, les équipements et n° de série seront transférés vers la nouvelle revalorisation.  
              value: 0
              
    date_next_relance: 
        rows: 
            - field: date_next_relance
            
    irrecouvrable: 
        rows: 
            - field: close_note
              label: Motif
              required: 1
              
    lines_to_facture: 
        rows: 
            facture: 
                custom: 1
                label: Facture
                input_name: id_facture
                data_type: id
                input: 
                    type: select
                    options: 
                        array: draftFacturesForRefacture
                        
    cancel_refacture: 
        extends: lines_to_facture
        rows: 
            facture: 
                label: Refacturer vers
                input: 
                    options: 
                        callback: 
                            method: getDraftFacturesForRefactureArray
                            params: 
                                - 1
                   
    export_to_chorus: 
        rows: 
            - custom: 1
              label: Structure
              input_name: id_structure
              content: 
                  callback: renderClientSelectChorusStructuresInput
            - custom: 1
              label: Code Service
              input_name: code_service
              content: 
                  callback: renderClientSelectChorusServicesInput
              depends_on: id_structure
            - custom: 1
              label: Fichiers joints
              input_name: join_files
              data_type: id_object
              input: 
                  type: check_list
                  items: 
                      callback: 
                          method: getAllFiles
                          params: 
                              - 0
              depends_on: id_model
              object: files
              create_form: upload
              create_form_label: Ajouter
              create_form_values: 
                  fields: 
                      parent_module: 
                          prop: module
                      parent_object_name: 
                          prop: object_name
                      id_parent: 
                          prop: id
            - custom: 1
              label: Fichier a joindre
              input_name: files_compl
              content:
                  callback: 
                    method: renderMailExtraFilesInput
                    params:
                        - files_compl
                        
    demander_validation_avoir:
        rows: 
            - custom: 1
              label: Motif de la demande
              input_name: motif
              input: 
                  type: select
                  options: 
                      array: motif_demande_avoir
                      
            - custom: 1
              label: Avoir total
              input_name: avoir_total
              data_type: bool
              input: 
                  type: toggle
              default_value: 1
                      
            - custom: 1
              label: Montant
              input_name: montant
#                 data_type: money
              input: 
                  type: text
              display_if: 
                  field_name: avoir_total
                  hide_values: 1
              
        
            - custom: 1
              label: Commentaire
              input_name: comment
              input: 
                  type: textarea
                  rows: 3
                  auto_expand: 1
              hashtags: 1


            - custom: 1
              label: Fichiers joints
              input_name: join_files
              data_type: id_object
              input: 
                  type: check_list
                  items: 
                      callback: 
                          method: getAllFiles
                          params: 
                              - 0
              object: files
              create_form: upload_light
              create_form_label: Ajouter
              create_form_values: 
                  fields: 
                      parent_module: 
                          prop: module
                      parent_object_name: 
                          prop: object_name
                      id_parent: 
                          prop: id
 
    validation_avoir:
        rows:

            - field: valid_avoir
              
            - field: valid_avoir_montant_accorder
              value:
                callback:
                  method: getData
                  params:
                    - valid_avoir_montant
              display_if: 
                  field_name: valid_avoir
                  hide_values: 0
                          
            - custom: 1
              label: Raison de refus
              input_name: comment
              input: 
                  type: textarea
                  rows: 3
                  auto_expand: 1
              hashtags: 1
                    
            - custom: 1
              label: Images liées
              content: 
                  callback: renderImagesDemandeAvoir
                  
fields_tables: 
    infos:
        footer_extra_btn: 
            callback: getInfosExtraBtn
        rows: 
            - field: replaced_ref
              show: 
                  field_value: replaced_ref
            - label: Type
              value: 
                  callback: displayType
            - field: libelle
              edit: 1
            - field: expertise
              edit: 1
            - field: fk_statut
            - field: paye
            - field: paiement_status
            - field: centre
            - field: entrepot
              display: nom_url
            - field: ef_type
              edit: 1
            - field: datef
              edit: 1
            - field: zone_vente
              edit: 1
            - label: Commercial
              value: 
                  callback: displayCommercial
            - field: id_user_commission
              display: nom_url
              show: 
                  callback: showUserCommission
            - field: id_entrepot_commission
              display: nom_url
              show: 
                  callback: showEntrepotCommission
#            - label: Zone de vente
#              value:
#                  callback: displayZoneVenteField
            - label: Etat comptable
              value:
                  callback: renderExportedField
            - field: ignore_compta
            - field: statut_export
              edit: 1
            - field: douane_number
              edit: 1
            - field: litige
              edit: 1
            - field: chorus_status
            - label: Infos export Chorus
              value: 
                  callback: displayChorusData
            - field: fk_project
              edit: 1
                  
    client: 
        rows: 
            - field: fk_soc
              display: card
            - field: ref_client
              edit: 1
            - label: Remises client
              value: 
                  callback: displayRemisesClient
            - field: id_client_final
            
    payment:
        rows:
            - field: fk_account    
              edit: 1
            - field: fk_cond_reglement
              edit: 1
            - field: fk_mode_reglement
              edit: 1
            - field: rib_client
              edit: 1
            - field: prelevement
              edit: 1
              show: 
                  callback: showPrelevement
            - field: date_lim_reglement
            - field: relance_active
              edit: 1
            - field: nb_relance
            - field: date_relance
              show: 
                  field_value: nb_relance
            - label: Date de prochaine relance
              value: 
                  callback: displayDateNextRelance
            - label: Facture irrécouvrable
              value: 
                  callback: displayIrrecouvrableInfos
              show: 
                  callback: isIrrecouvrable
            - label: Avoir potentiel
              value: 
                  callback: displayPotentielRemise
            - field: date_cfr
              edit: 1
                
    pdf: 
        rows: 
            - field: pdf_hide_pu
              edit: 1
            - field: pdf_hide_ref
              edit: 1
            - field: pdf_nb_decimal
              edit: 1
#            - field: pdf_hide_reduc
#              edit: 1
#            - field: pdf_hide_total
#              edit: 1
#            - field: pdf_hide_ttc
#              edit: 1
            - field: pdf_hide_livraisons
              edit: 1
            - label: Fichier PDF
              value: 
                  callback: displayPDFButton
                                                 
    totals: 
        rows: 
            - label: Remises
              value: 
                  callback: displayTotalRemises
            - field: total_ht
            - field: total_tva
            - field: total_ttc
            - field: prime
            - field: prime2
            
    notes:
        rows:
            - field: close_note
            - field: note_public
            - field: note_private
            - field: logs
            
            
    avoir:
        title: Avoir
        icon: exchange-alt
        footer_extra_btn: 
            callback: getAvoirExtraBtn
        rows:
            - field: valid_avoir
            - field: valid_avoir_montant
            - field: valid_avoir_montant_accorder
            - field: valid_avoir_id_user_ask
            - field: valid_avoir_id_user
            
views: 
    default: 
        objects_change_reload: Bimp_FactureLine,Bimp_Paiement,ObjectLineRemise,BimpFile,BimpRevalorisation,RemiseGlobale
        rows: 
            0: 
                cols: 
                    1: 
                        rows: 
                            2: 
                                cols: 
                                    - type: fields_table
                                      fields_table: 
                                          name: avoir
    content_infos: 
        objects_change_reload: Bimp_FactureLine,Bimp_Paiement,ObjectLineRemise,BimpFile,BimpRevalorisation,RemiseGlobale
    full: 
        objects_change_reload: Bimp_FactureLine,Bimp_Paiement,ObjectLineRemise,BimpFile,BimpRevalorisation,RemiseGlobale
        
filters: 
    revals_prevues: 
        label: Revalorisations prévues
        type: range
        data_type: money
    revals_brouillons: 
        label: Revalorisations en attente
        type: range
        data_type: money
    revals_ok: 
        label: Revalorisations acceptées
        type: range
        data_type: money
    tech_sav: 
        label: Technicien SAV
        type: value
        input: 
            type: search_user
            
filters_panels: 
    default: 
        filters: 
            fk_availability: unset            
            ref: 
            paiement_status: 
            date_lim_reglement:
            datef: 
                
lists_cols:
    ref: 
        object_link: 1
    pdf: 
        label: Fichier PDF
        value: 
            callback: 
                method: displayPDFButton
                params: 
                    - false
        available_csv: 0
    revalOk:
        label: Reval. OK
        value: 
            callback: 
                method: displayReval
                params: 
                    - ok
    #remplacée par field marge_finale_ok
    revalOkPlusMarge: 
        label: Marge + Reval. OK (obsolète)
        value: <span class="danger">Cette colonne est obsolète veuillez la supprimer de votre configuration et ajouter la nouvelle colonne portant le même nom</span>
    revalPrevuPlusMarge:
        label: Marge + Reval. prévues
        value: 
            callback: 
                method: displayReval
                params: 
                    - prevu+marge
    tx_marge: 
        label: Tx marge
        value: 
            callback: 
                method: displayTxMarge
    tx_marque: 
        label: Tx marque
        value: 
            callback: 
                method: displayTxMarque
        
    secteur_comm_check: 
        label: Secteur
        value: 
            callback: displaySecteurWithCommercialCheck
    sav_equipment: 
        label: Equipement SAV
        value: 
            callback: 
                method: displayInfoSav
                params:
                    - equipment
    sav_product: 
        label: Produit SAV
        value: 
            callback: 
                method: displayInfoSav
                params:
                    - product
    sav_product_info: 
        label: Produit label
        value: 
            callback: 
                method: displayInfoSav
                params:
                    - productInfo
    sav_equipment_waranty: 
        label: Garantie SAV
        csv_needed_fields: 
            - rowid
        value: 
            callback: 
                method: displayInfoSav
                params:
                    - waranty
    sav_sav: 
        label: SAV
        value: 
            callback: 
                method: displayInfoSav
                params:
                    - sav
    sav_gsx_number: 
        label: SAV commande Apple
        value: 
            callback: 
                method: displayInfoSav
                params:
                    - apple_number
    duplicata: 
        label: Duplicata
        value: 
            callback: diplayDuplicataButton 
    retard_paiment:
        label: Retard paiement
        value:
            callback: displayRetard
    paiements: 
        label: Paiements
        value:
            callback: displayPaiements
    clients_commandes:
        label: Client(s) Commande(s)
        value:
            callback: displayClientsCommandes
        
lists: 
    default: 
        total_row: 1
        title: Factures
        icon: fas_file-invoice-dollar
        sort_field: datec
        sort_way: desc
        add_btn_label: Créer une nouvelle facture
        extra_btn:
            callback: getActionsButtonsList
        bulk_actions:
            delete: 
                label: supprimer les factures sélectionnées
        extra_bulk_actions: 
            callback: getListExtraBulkActions
        list_actions: 
            callback: getListExtraListActions
        add_form_values: 
            fields: 
                entrepot: 
                    request: id_entrepot
                fk_soc:
                    request: id_client
        delete_btn: 0
        cols: 
            ref: 
            type: 
            fk_statut: 
            paiement_status: 
            fk_soc:
            commercial:
            total_ttc: 
            pdf:
        
    logistique: 
        extends: default
        configurable: 0
        filters_panel: unset
        extra_btn: 
            callback: getLogistiqueListExtraButtons
            
    client: 
        extends: default
        n: 10
        cols: 
            soc: unset
            
    commission: 
        total_row: 1
        position: 0
        configurable: 1
        pagination: 1
        n: 20
        sort_field: datec
        sort_way: asc
        extra_btn: 
            callback:
                method: getCommissionListButtons
        modal_view: full
        page_btn: 1
        cols: 
            ref: 
            type: 
            date_valid:
            commercial:
            secteur_comm_check:
            statut: 
            paiement_status: 
            total_ht: 
            total_pa:
            marge: 
            
    user_commission: 
        extends: commission
        extra_btn: 
            callback: 
                params: 
                    - 1

    entrepot_commission: 
        extends: commission
        extra_btn: 
            callback: 
                params: 
                    - 2
            
    public_client: 
        total_row: 1
        configurable: 0
        sort_field: datef
        sort_way: desc
        delete_btn: 0
        cols: 
            ref: 
                display: default
            type: 
            datef: 
            paiement_status:
            commercial:
                display: nom
            total_ttc: 
            duplicata:
        
cards: 
    default: 
        title: 
            field_value: ref
        status: fk_statut
        view_btn: 1
        fields: 
            - field: replaced_ref
            - field: total_ttc
            - field: paiement_status
            - label: Fichier PDF
              value: 
                  callback: displayPDFButton
                  
    light: 
        title: 
            field_value: ref
        status: fk_statut
        view_btn: 0
        fields: 
            replaced_ref: 
                field: replaced_ref
            total: 
                field: total_ttc
            paiement_status: 
                field: paiement_status
                  
    detail: 
        extends: light
        fields: 
            client: 
                field: fk_soc
                display: nom_url
        
searches:
    default: 
        fields_search: 
            - a.rowid
            - a.ref
            - ef.libelle
            - s.nom
        joins:
            ef: 
                table: facture_extrafields
                on: a.rowid = ef.fk_object
                alias: ef
            s: 
                table: societe
                on: a.fk_soc = s.rowid
                alias: s
        fields_return: 
            - a.ref
            - s.nom
            - ef.libelle
        label_syntaxe: '<a.ref> - <ef.libelle> (Client: <s.nom>)'
        
stats_lists_cols: 
    marge:
        field: marge
        data_type: money
    tot_ht: 
        field: total_ht
    tot_brouillon: 
        label: Tot. Fac. brouillons
        type: sum
        data_type: money
        decimals: 2
        with_styles: 1
        field: total_ttc
        filters: 
            fk_statut: 0
    tot_valide: 
        label: Tot. Fac. validées
        type: sum
        field: total_ttc
        data_type: money
        decimals: 2
        with_styles: 1
        filters: 
            fk_statut: 
                in: 
                    - 1
                    - 2
    tot_abandon: 
        label: Tot. Fac. abandonnées
        type: sum
        field: total_ttc
        data_type: money
        decimals: 2
        with_styles: 1
        filters: 
            fk_statut: 3
                   
stats_lists: 
    default: 
        cols: 
            marge:
            nb:
            tot_brouillon:
            tot_valide:
            tot_abandon: 

graph:
    parDay:
        xDateConfig:
            field: datef
    parBoutique:
        xDateConfig:
            field: datef
    parBoutiqueMarge:
        xDateConfig:
            field: datef
