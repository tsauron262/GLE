table: bimpcore_note
common_fields: 1
icon: fas_sticky-note

mode_archive: 0

labels: 
    name: note
    is_female: 1
    
parent_module: 
    field_value: obj_module
parent_object: 
    field_value: obj_name
parent_id_property: id_obj

objects:
    user_group:
        relation: hasOne
        delete: 0
        instance: 
            dol_object: 
                module: user
                file: usergroup
                class: UserGroup
            id_object:
                field_value: fk_group_dest
    
fields:
    obj_type: 
        label: Type objet
        input: 
            type: hidden
    obj_module: 
        label: Module
        input: 
            type: hidden
    obj_name: 
        label: Nom objet
        input: 
            type: hidden
    id_obj: 
        label: ID objet
        input: 
            type: hidden
    type_author: 
        label: Type Auteur
        type: int
        values: 
            array: types_author
        default_value: 1
    id_societe: 
        label: Société
        type: id_object
        object: societe
        input: 
            type: search_societe
        display_if: 
            field_name: type_author
            show_values: 2
    email: 
        label: E-mail
        display_if: 
            field_name: type_author
            show_values: 3
    visibility: 
        label: Visibilité
        type: int
        values: 
            array: visibilities
        default_value: 3
    content: 
        label: Texte
        type: text
        hashtags: 1
        input: 
            auto_expand: 1
            rows: 1
            note: 1
    viewed: 
        label: Vue
        type: bool
        default_value: 0
    type_dest: 
        label: Type Destinataire
        type: int
        values: 
            array: types_dest
        default_value: 0
    fk_user_dest:
        label: Destinataire user
        type: id_object
        object: user
        input: 
            type: search_user
            include_empty: 1
        display_if: 
            field_name: type_dest
            show_values: 1
    fk_group_dest:
        label: Destinataire groupe
        type: id_object
        object: user_group
        input: 
            type: search_group
            include_empty: 1
        display_if: 
            field_name: type_dest
            show_values: 2
        values:
            array: userGroups
    auto:
        label: Note Auto
        type: bool
        default_value: 0
        
forms: 
    default: 
        rows: 
            - field: obj_type
            - field: obj_module
            - field: obj_name
            - field: id_obj
            - field: type_author
            - field: id_societe
            - field: email
            - field: visibility
            - field: type_dest
            - field: fk_user_dest
            - field: fk_group_dest
            - field: content
            
    edit: 
        rows: 
            - field: visibility
            - field: content
            
    msg: 
        rows: 
            - field: obj_type
            - field: obj_module
            - field: obj_name
            - field: id_obj
            - field: type_author
              hidden: 1
            - field: type_dest
            - field: fk_user_dest
            - field: fk_group_dest
            - field: content
    rep: 
        rows: 
            - field: obj_type
            - field: obj_module
            - field: obj_name
            - field: id_obj
            - field: type_author
              hidden: 1
            - field: type_dest
              hidden: 1
            - field: fk_group_dest
              edit: 0
            - field: fk_user_dest
              edit: 0
#            - field: content
            - custom: 1
              label: Texte
              input_name: content
              input: 
                  type: textarea
                  auto_expand: 1
                  rows: 3
                  
lists_cols: 
    date_create:
        label: Date
    author:
        label: Auteur
        value: 
            callback: displayAuthor
    to:
        label: Destinataire(s)
        value: 
            callback: displayDestinataire
    chatmsg:
        label: Destinataire(s)
        value: 
            callback: displayChatmsg
    parent:
        label: Objet liée
        value:
            callback: getParentLink
                    
lists:
    default: 
        title: Notes
        icon: fas_sticky-note
        filters_panel: default
        checkboxes: 1
        bulk_actions: 
            - label: Supprimer les notes sélectionnées
              icon: fas_trash-alt
              onclick: deleteSelectedObjects('list_id', $(this));
              btn_class: deleteSelectedObjects
        sort_field: date_create
        sort_way: desc
        n: 50
        edit_btn: 1
        edit_form: edit
        delete_btn: 1
        add_form_name: default
        extra_btn: 
            callback: getListExtraBtn
        cols:
            date_create:
            author:
            visibility:
                edit: 1
            content:
                min_width: 400
            to:
            viewed:
                edit: 1
                
    global: 
        extends: default
        add_form_name: unset
        add_btn: 0
                
    public: 
        title: Suivi
        icon: fas_history
        checkboxes: 0
        configurable: 0
        enable_search: 0
        sort_field: date_create
        sort_way: asc
        n: 50
        cols:
            author: 
            date_create: 
            content:
                label: Message
                edit: 1
             
    message:
        extends: default
        title: Messages
        add_form_name: msg
        add_form_values: 
            fields:
                type_author: 1
                type_dest: 1
        cols:
            visibilite: unset
            
    chat:
        title: Messages
        n: 100
        add_form_name: msg
        add_form_values: 
            fields:
                type_author: 1
                type_dest: 1
        cols:
            chatmsg:
                label: Destinataire(s)
                value: 
                    callback: displayChatmsg
                    
    bal:
        extends: default
        cols:
            parent:
            
searches: 
    default: 
        fields_search: 
            - a.id
        fields_return: 
            - a.id
        label_syntaxe: 'Note #<a.id>'
        
filters_panels:
    default:
        filters:
            user_create: