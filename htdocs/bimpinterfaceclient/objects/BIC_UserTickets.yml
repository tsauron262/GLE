extends: 
    module: bimpsupport
    object_name: BS_Ticket

objects:
    contrat:
        instance:
            dol_object:
                module: contrat
                file: contrat
            id_object:
                request: id
    
    societe:
        instance:
            dol_object:
                module: societe
                file: societe
            id_object:
                field_value: id_client
                
    notes:
        instance:
            bimp_object: 
                module: bimpsupport
                name: BS_Note
        list: 
            filters: unset
    
    userClient:
        instance:
            bimp_object: BIC_UserClient
        id_object:
            field_value: id_user_client
    
fields:
    id_contrat:
        label: Contrat
        type: id_object
        object: contrat
        display: nom
    
    id_client:
        label: Pour la société
        type: id_object
        object: societe
    
    id_user_client:
        label: Demandeur
        type: id_object
        object: userClient
        
    priorite_demande_client:
        label: Priorité
    
    impact_demande_client:
        label: Impact
    
lists:
    interface_client:
        title: Tickets support
        sort_field: date_create
        sort_way: desc
        n: 25
        add_form_name: addUserTicket
        add_btn_label: Nouveau ticket support
        edit_btn: 1
        edit_form: editUserTicket
        list_filters: 
            callback:
                method: getListFiltersInterface
                params:
                    - contrat
        add_form_values: 
            fields:
                status: 20
                id_client:
                    callback: 
                        method: userClient
                        params:
                            - attached_societe
                id_contrat:
                    callback: currentContrat
                id_user_client:
                    callback:
                        method: userClient
                        params:
                            - id
        page_btn: 1
        cols:
            ticket_number:
            sujet:
            status:
            priorite_demande_client:                
            date_create:
            id_user_client:
    
    pageUser:
        extends: interface_client
        add_btn: 0
        list_filters: 
            callback:
                method: getListFiltersInterface
                params:
                    - user
        cols:
            id_contrat:
                label: Contrat
                display: nom
                
    pageClient:
        extends: interface_client
        add_btn: 0
        list_filters: 
            callback:
                method: getListFiltersInterface
                params:
                    - client
        cols:
            id_contrat:
                label: Contrat
                display: nom
            
forms:
    editUserTicket:
        rows:
            - field: id_contrat
              edit: 0
            - field: status
              edit: 0
            - field: sujet
            - field: priorite
            - field: impact
           
    addUserTicket:
        msgs:
            - content: Ne pas mettre d'informations confidentielles dans le sujet du ticket
              type: info
        rows:
            - field: id_client
              edit: 0
            - field: id_contrat
              edit: 0
            - field: id_user_client
              edit: 0
            - field: contact_in_soc
              label: Utilisateur
            - custom: 1
              label: Choix
              required: 1
              input_name: choix
              values: 
                array: arrayTypeSerialImei
              input: 
                type: switch_options
            - custom: 1
              label: N° Série / N° IMEI ou Service
              required: 1
              input_name: serial_imei
              input: 
                  type: text
            - custom: 1
              label: Adresse d'envoi
              input_name: adresse_envois
              input:
                  type: text
            - custom: 1
              label: Adresse mail bon de retour
              input_name: adress_bon_retour
              input:
                  type: text
            - field: status
              edit: 0
            - field: sujet
              required: 1
            - field: priorite
            - field: impact
            - object: notes
              form_name: addClientNote
              multiple: 1
            - object: files
              multiple: 1
              form_name: upload
              form_values:
                  fields:
                      parent_module: bimpsupport
                      parent_object_name: BS_Ticket
                      id_parent: 1