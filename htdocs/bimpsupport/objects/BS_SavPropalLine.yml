extends: 
    module: bimpcore
    object_name: Bimp_PropalLine

table: bs_sav_propal_line

labels: 
    name: ligne du devis
    name_plur: lignes du devis
    is_female: 1
    
objects: 
    reservation: 
        relation: hasOne
        delete: 1
        instance: 
            bimp_object: 
                module: bimpreservation
                name: BR_Reservation
            id_object: 
                field_value: id_reservation
                
fields: 
    id_reservation: 
        label: Réservation
        type: id_object
        object: reservation
        input: 
            type: hidden
        default_value: 0
        
    out_of_warranty:
        label: Hors garantie
        type: bool
        default_value: 1
        display_if:
            field_name: type
            show_values: 1
        
forms: 
    default: 
        rows: 
            - field: type
              hidden: 
                  field_value: id
            
            - custom: 1
              label: Produit
              value: 
                  callback: getIdProductFromPost
              input_name: id_product
              content: 
                  callback: 
                      method: renderLineInput
                      params: 
                          - id_product
              display_if: 
                  fields_names: type,id_equipment
                  type: 
                      hide_values: 2
                  id_equipment: 
                      show_values: 0,
              depends_on: id_equipment
              show:
                  callback: isProductEditable
              
            - field: id_equipment
              show:
                  callback: isProductEditable
            
            - custom: 1
              label: Prix unitaire HT
              value: 
                  prop: pu_ht
              input_name: pu_ht
              content: 
                  callback: 
                      method: renderLineInput
                      params: 
                          - pu_ht
              display_if: 
                  field_name: type
                  show_values: 1
              depends_on: id_product,id_equipment
              
            - custom: 1
              label: Taux de TVA
              value: 
                  prop: tva_tx
              input_name: tva_tx
              content: 
                  callback: 
                      method: renderLineInput
                      params: 
                          - tva_tx
              display_if: 
                  field_name: type
                  show_values: 1
              depends_on: id_product,id_equipment
              
            - custom: 1
              label: Quantité
              value: 
                  prop: qty
              input_name: qty
              content: 
                  callback: 
                      method: renderLineInput
                      params: 
                          - qty
              display_if: 
                  field_name: type
                  show_values: 1
              depends_on: id_product,id_equipment
                  
            - custom: 1
              label: Remise
              value: 
                  prop: remise
              input_name: remise
              content: 
                  callback: 
                      method: renderLineInput
                      params: 
                          - remise
              display_if: 
                  field_name: type
                  show_values: 1
                  
            - field: out_of_warranty
            
            - custom: 1
              label: Prix d'achat
              input_name: id_fourn_price
              data_type: id_object
              object: fournisseur_price
              content: 
                  callback: 
                      method: renderLineInput
                      params: 
                          - id_fourn_price
              required: 1
              display_if: 
                  field_name: type
                  show_values: 1
              depends_on: id_product,id_equipment
              create_form: default
              create_form_values: 
                  fields: 
                      fk_product: 
                          callback: getIdProductFromPost
              value: 
                  callback: getIdFournPriceFromPost
                  
            - custom: 1
              label: Description
              value: 
                  prop: desc
              input_name: desc
              content: 
                  callback: 
                      method: renderLineInput
                      params: 
                          - desc
                      
lists: 
    default: 
        objects_change_reload: BS_SAV,BS_ApplePart
        cols: 
            warranty: 
                field: out_of_warranty
                edit: 
                    callback: isLineProduct
                item_show: 
                    callback: showWarranty
